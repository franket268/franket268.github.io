<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>My blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description">
<meta property="og:type" content="website">
<meta property="og:title" content="My blog">
<meta property="og:url" content="http://yoursite.com/index.html">
<meta property="og:site_name" content="My blog">
<meta property="og:description">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="My blog">
<meta name="twitter:description">
  
    <link rel="alternative" href="/atom.xml" title="My blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  <link rel="stylesheet" href="/css/style.css" type="text/css">
  <script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
</head>
<body>
  <div id="container">
    <div class="left-col">
    <div class="overlay"></div>
<div class="intrude-less">
	<header id="header" class="inner">
		<a href="/" class="profilepic">
			<img lazy-src="http://7xjj4n.com1.z0.glb.clouddn.com/avatar.jpg" class="js-avatar">
		</a>

		<hgroup>
		  <h1 class="header-author"><a href="/">franket268</a></h1>
		</hgroup>

		

		
			<div class="switch-btn">
				<div class="icon">
					<div class="icon-ctn">
						<div class="icon-wrap icon-house" data-idx="0">
							<div class="birdhouse"></div>
							<div class="birdhouse_holes"></div>
						</div>
						<div class="icon-wrap icon-ribbon hide" data-idx="1">
							<div class="ribbon"></div>
						</div>
						
						
					</div>
					
				</div>
				<div class="tips-box hide">
					<div class="tips-arrow"></div>
					<ul class="tips-inner">
						<li>菜单</li>
						<li>标签</li>
						
						
					</ul>
				</div>
			</div>
		

		<div class="switch-area">
			<div class="switch-wrap">
				<section class="switch-part switch-part1">
					<nav class="header-menu">
						<ul>
						
							<li><a href="/">主页</a></li>
				        
							<li><a href="/archives">所有文章</a></li>
				        
						</ul>
					</nav>
					<nav class="header-nav">
						<div class="social">
							
								<a class="github" target="_blank" href="/#" title="github">github</a>
					        
								<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
					        
								<a class="rss" target="_blank" href="/#" title="rss">rss</a>
					        
								<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
					        
						</div>
					</nav>
				</section>
				
				
				<section class="switch-part switch-part2">
					<div class="widget tagcloud" id="js-tagcloud">
						<a href="/tags/Android动画/" style="font-size: 10px;">Android动画</a>
					</div>
				</section>
				
				
				

				
			</div>
		</div>
	</header>				
</div>
    </div>
    <div class="mid-col">
      <nav id="mobile-nav">
  	<div class="overlay">
  		<div class="slider-trigger"></div>
  		<h1 class="header-author js-mobile-header hide">franket268</h1>
  	</div>
	<div class="intrude-less">
		<header id="header" class="inner">
			<div class="profilepic">
				<img lazy-src="http://7xjj4n.com1.z0.glb.clouddn.com/avatar.jpg" class="js-avatar">
			</div>
			<hgroup>
			  <h1 class="header-author">franket268</h1>
			</hgroup>
			
			<nav class="header-menu">
				<ul>
				
					<li><a href="/">主页</a></li>
		        
					<li><a href="/archives">所有文章</a></li>
		        
		        <div class="clearfix"></div>
				</ul>
			</nav>
			<nav class="header-nav">
				<div class="social">
					
						<a class="github" target="_blank" href="/#" title="github">github</a>
			        
						<a class="weibo" target="_blank" href="/#" title="weibo">weibo</a>
			        
						<a class="rss" target="_blank" href="/#" title="rss">rss</a>
			        
						<a class="zhihu" target="_blank" href="/#" title="zhihu">zhihu</a>
			        
				</div>
			</nav>
		</header>				
	</div>
</nav>
      <div class="body-wrap">
  
    <article id="post-google2f3c6328cd85be28" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/11/google2f3c6328cd85be28/" class="article-date">
  	<time datetime="2015-06-11T13:58:55.000Z" itemprop="datePublished">2015-06-11</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
    <div class="article-entry" itemprop="articleBody">
      
        google-site-verification: google2f3c6328cd85be28.html
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-Animation" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/06/Animation/" class="article-date">
  	<time datetime="2015-06-06T10:31:25.000Z" itemprop="datePublished">2015-06-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/06/Animation/">Android的三种动画:Property Animation,View Animation,Drawable Animation</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>  Android中动画分为三种,Property Animation,View Animation和Drawable Animation。我们也经常俗称它们为Property 动画，Tween动画和Frame动画。</p>
<h2 id="View_Animation">View Animation</h2><p>  View Animation能对view进行简单的动画操作，如透明度改变，平移，拉伸和旋转等。使用时先在res/anim文件夹下新建一个xml文件。这个文件的根元素可以是&lt;alpha>, &lt;scale&gt;, &lt;translate>, &lt;rotate>,interpolator元素或者是集合&lt;set&gt;。例如我在下面定义一个set，实现一个view从（0,0）坐标移到（200,0）坐标，透明度从100%变成全透明。</p>
<pre><code>&lt;set xmlns:<span class="variable">android=</span><span class="string">"http://schemas.android.com/apk/res/android"</span>
  android:<span class="variable">interpolator=</span><span class="string">"@android:interpolator/accelerate_cubic"</span>&gt;
  &lt;translate
    android:<span class="variable">fromXDelta=</span><span class="string">"0"</span>
    android:<span class="variable">toXDelta=</span><span class="string">"200"</span>
    android:<span class="variable">duration=</span><span class="string">"3000"</span> /&gt;
  &lt;alpha
    android:<span class="variable">fromAlpha=</span><span class="string">"1.0"</span>
    android:<span class="variable">toAlpha=</span><span class="string">"0.0"</span>
    android:<span class="variable">duration=</span><span class="string">"3000"</span>/&gt;
&lt;/set&gt;
</code></pre><p>  然后可以通过以下java代码实现该动画。</p>
<pre><code>public <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword"><span class="keyword">extends</span></span> <span class="title">Activity</span> {</span>
  <span class="annotation">@Override</span>
  <span class="keyword">protected</span> void onCreate(<span class="type">Bundle</span> savedInstanceState) {
    <span class="keyword">super</span>.onCreate(savedInstanceState);
    setContentView(<span class="type">R</span>.layout.activity_main);
    <span class="keyword">final</span> <span class="type">Button</span> button = (<span class="type">Button</span>) findViewById(android.<span class="type">R</span>.id.button1);
    <span class="keyword">final</span> <span class="type">Animation</span> animation = <span class="type">AnimationUtils</span>.loadAnimation(<span class="keyword">this</span>,<span class="type">R</span>.anim.buton_anim);
    button.setOnClickListener(<span class="keyword">new</span> <span class="type">View</span>.<span class="type">OnClickListener</span>() {
    <span class="annotation">@Override</span> public void onClick(<span class="type">View</span> v) {
      button.startAnimation(animation);
    }
    });
  }
}
</code></pre><p>  通过这段代码，我们看到当点击按钮的时候，按钮就会从左往右移动，移动同时按钮逐渐变透明。我们能发现当动画结束的时候，按钮就会回到原来的（0，0）位置，并且透明度恢复原样。除此外，当按钮移动的过程，如果点击移动中的按钮，按钮并没有反应，但是点击按钮一开始的位置，移动中的按钮会重新回到原来的位置在此向右平移。所以其实在我们看来按钮是在移动，但按钮的实体还是在原来的位置。所以我们只有点击按钮原来的位置才会对被按钮接受到。</p>
<p>  为了解决这个问题，Property Animation产生了。</p>
<h2 id="Peoperty_Animation">Peoperty Animation</h2><p>  Property Animation 有三个动画执行类：ValueAnimator，ObjectAnimatior和AnimatorSet。ValueAnimator是一个可以在动画执行过程中计算动画属性值的的执行类。ObjectAnimator是ValueAnimator的子类，它使用起来比ValueAnimator简单。AnimatorSet是动画集合，它能让一组同时或者按某个排序执行。</p>
<p><strong><em>ValueAnimator</em></strong> </p>
<p>  先介绍ValueAnimator，它实现了两个重要的接口TimeInterpolator和TypeEvaluator。TimeInterpolator用来定义动画的变化率，如加速变化或者减速。TypeEvaluator是定动画操作属性的类型。作为属性动画，ValueAnimator是通过更新view的属性值来实现动画的</p>
<p>  来看看怎么使用ValueAnimator。还是使用上面水平平移的按钮为例子，下面是在java代码中用ValueAnimator实现这样的效果。</p>
<pre><code><span class="annotation">@Override</span>
<span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{
  <span class="keyword">super</span>.onCreate(savedInstanceState);
  setContentView(R.layout.activity_main);
  <span class="keyword">final</span> Button button = (Button) findViewById(android.R.id.button1);
  button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {
    <span class="annotation">@Override</span> <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>{
      <span class="keyword">final</span> ValueAnimator animator = ValueAnimator.ofFloat(<span class="number">0</span>f,<span class="number">200</span>f);
      animator.setTarget(button);
      animator.setDuration(<span class="number">4000</span>);
      animator.start();
      animator.addUpdateListener(<span class="keyword">new</span> ValueAnimator.AnimatorUpdateListener() {
        <span class="annotation">@Override</span> <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onAnimationUpdate</span><span class="params">(ValueAnimator animation)</span> </span>{
         button.setTranslationX((<span class="keyword">float</span>)animator.getAnimatedValue());          
        }                   
      });
    }
  });
}
</code></pre><p>  首先可以通过ValueAnimator的ofInt(),ofFloat()或ofObject()方法来设置动画的范围值。因为我想把按钮从（0，0）坐标平移到（200，0），所以我设成范围为 ValueAnimator.ofInt(0,200)。</p>
<p>  然后动画的target设为该button。</p>
<p>  动画的时间为4秒。</p>
<p>  接着为动画添加一个AnimatorUpdateListener。这个listener的作用就是实时更新button的属性值。这里就是更新button的平移X值。这里要说一下animator.getAnimatedValue()这个方法。这个方法得到的值是每一帧动画根据范围，时间和TimeInterpolator算出来的当前值。例如我的动画范围是0到200，动画时间是4秒，TimeInterpolator不设置就是使用匀速变化。所以0秒时。getAnimatedValue（）的值为0，时间为两秒时，button的要改变的属性值也应该是总值的一半。所以两秒时getAnimatedValue（）的值是（200-0）*（2/4）=100。时间为4秒时，该值就是（200-0)*(4/4) = 200，也就是我们想要设的最终值了。当然，如果想按钮平移的同时透明度也改变，我们也可以在UpdateListener里根据getAnimatedValue的值来调button.setAlpha()。</p>
<p>  最终我们可以看到按钮平移后不会回到原来位置，并且移动中的按钮是可以点击的。这就说明view的实体确实是在移动，这是跟ViewAnimation最大的不同。  </p>
<p><strong><em>ObejctAnimator</em></strong></p>
<p>  ObjectAnimator是ValueAnimator的子类，它需要指定动画的对象和对象的属性，并且能自动更新该属性的值，而不需要像上面的ValueAnimator那样自己在UpdateListener里通过set方法手动设置每一帧的属性值。</p>
<p>  来看看ObjectAnimator实现平移按钮的代码。</p>
<pre><code><span class="annotation">@Override</span>
<span class="keyword">protected</span> <span class="function"><span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>{
  <span class="keyword">super</span>.onCreate(savedInstanceState);
  setContentView(R.layout.activity_main);
  <span class="keyword">final</span> Button button = (Button) findViewById(android.R.id.button1);
  button.setOnClickListener(<span class="keyword">new</span> View.OnClickListener() {
    <span class="annotation">@Override</span> <span class="keyword">public</span> <span class="function"><span class="keyword">void</span> <span class="title">onClick</span><span class="params">(View v)</span> </span>{
      ObjectAnimator anim =ObjectAnimator.ofFloat(button,<span class="string">"translationX"</span>,<span class="number">0</span>f,<span class="number">200</span>f);
      anim.setDuration(<span class="number">4000</span>);
      anim.start();
    }
  });
}
</code></pre><p>这段代码中，ObjectAnimator指定了对象为button，要更新的属性为translationX，范围为0f到200f。这里要说一下的是，属性值必须是对象里拥有的属性值，并且该属性值有setter和getter方法。如果我们要改变一个view里没有setter和getter方法的属性，我们可以自定义一个view并继承之要改变属性的那个view，然后自己在自定义view实现改属性的setter和getter方法。由于这里View里本身就含有setTranslationX和getTanslationX方法，所以我们不需要自己实现。这样ObjectAnimator才能自动更行到该属性。</p>
<p><strong><em>AnimatorSet</em></strong></p>
<p>  AnimatorSet顾名思义就是一个动画集，你可以指定多个动画按照某个顺序执行。同样是按钮平移和变透明的例子。如下代码：</p>
<p>  @Override<br>    protected void onCreate(Bundle savedInstanceState) {<br>      super.onCreate(savedInstanceState);<br>      setContentView(R.layout.activity_main);<br>      final Button button = (Button) findViewById(android.R.id.button1);<br>      button.setOnClickListener(new View.OnClickListener() {<br>        @Override public void onClick(View v) {<br>          ObjectAnimator anim1 =ObjectAnimator.ofFloat(button,”translationX”,0f,200f);<br>          ObjectAnimator anim2 =ObjectAnimator.ofFloat(button,”alpha”,1f,0f);<br>          AnimatorSet animSet = new AnimatorSet();<br>          animSet.setDuration(4000);<br>          animSet.play(anim1).with(anim2);<br>          animSet.start();<br>        }                                                                         });<br>    }</p>
<p>  这里，我们通过animSet.play(anim1).with(anim2)控制两个动画同时执行，当我我们有三个动画anim1，anim2和anim3，并希望anim1先执行，然后anim2和anim3在anim1执行完后同时执行。就可以通过animSet.play(anim2).with(anim3).after(anim1)来实现。</p>
<p>  由于PropertyAnimatin是在3.0以后才出现的，所以要在3.0以前使用属性动画，可以使用开源动画库nineoldandroids。</p>
<h2 id="Drawable_Animation">Drawable Animation</h2><p>  最后剩下Drawable Animation了。Drawable Animatin就像走马灯一样讲将一连串图片依次播放的动画。这个真的没什么好讲的，直接用官方文档中例子。</p>
<p>  在res/drawable中新建一个XML文件，如下：</p>
<pre><code>&lt;animation-list xmlns:<span class="variable">android=</span><span class="string">"http://schemas.android.com/apk/res/android"</span>
  android:<span class="variable">oneshot=</span><span class="string">"true"</span>&gt;
  &lt;item android:<span class="variable">drawable=</span><span class="string">"@drawable/rocket_thrust1"</span> android:<span class="variable">duration=</span><span class="string">"200"</span> /&gt;
  &lt;item android:<span class="variable">drawable=</span><span class="string">"@drawable/rocket_thrust2"</span> android:<span class="variable">duration=</span><span class="string">"200"</span> /&gt;
  &lt;item android:<span class="variable">drawable=</span><span class="string">"@drawable/rocket_thrust3"</span> android:<span class="variable">duration=</span><span class="string">"200"</span> /&gt;
&lt;/animation-list&gt;
</code></pre><p>  xml设置了要要播放的图片和持续时间。其中oneshot属性为true时表明动画动画完毕后就停止了并显示最后一张图片。如果为false时表明动画会循环播放。</p>
<p>  以下是java代码：</p>
<pre><code>AnimationDrawable rocketAnimation;

public void onCreate<span class="params">(Bundle savedInstanceState)</span> {
  super.onCreate<span class="params">(savedInstanceState)</span>;
  setContentView<span class="params">(R.layout.main)</span>;
  ImageView rocketImage = <span class="params">(ImageView)</span> findViewById<span class="params">(R.id.rocket_image)</span>;
  rocketImage.setBackgroundResource<span class="params">(R.drawable.rocket_thrust)</span>;
  rocketAnimation = <span class="params">(AnimationDrawable)</span> rocketImage.getBackground<span class="params">()</span>;
}

public boolean onTouchEvent<span class="params">(MotionEvent event)</span> {
  <span class="keyword">if</span> <span class="params">(event.getAction<span class="params">()</span> == MotionEvent.ACTION_DOWN)</span> {
    rocketAnimation.start<span class="params">()</span>;
    return <span class="literal">true</span>;
  }
return super.onTouchEvent<span class="params">(event)</span>;
}
</code></pre><p>  要注意的是AnimationDrawable 的start（）方法不能再Actvity的OnCreate（）方法中调用。因为这是AnimationDrawable还没完全attached到Window上。</p>
<p>  到此，三种动画都简单介绍了一遍。其中我觉得ProprtyAnimation还有很多很有用的功能没提到，以后可能会再写单独写一篇文章探讨。</p>

      
    </div>
    
    <div class="article-info article-info-index">
      
	<div class="article-tag tagcloud">
		<ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Android动画/">Android动画</a></li></ul>
	</div>

      
	<div class="article-category tagcloud">
	<a class="article-category-link" href="/categories/Android/">Android</a>
	</div>


      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
    <article id="post-github博客正式开通" class="article article-type-post" itemscope itemprop="blogPost">
  
    <div class="article-meta">
      <a href="/2015/06/06/github博客正式开通/" class="article-date">
  	<time datetime="2015-06-06T09:18:49.000Z" itemprop="datePublished">2015-06-06</time>
</a>
    </div>
  
  <div class="article-inner">
    
      <input type="hidden" class="isFancy" />
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2015/06/06/github博客正式开通/">github博客正式开通</a>
    </h1>
  

      </header>
      
    
    <div class="article-entry" itemprop="articleBody">
      
        
      
    </div>
    
    <div class="article-info article-info-index">
      
      

      
      <div class="clearfix"></div>
    </div>
    
  </div>
  
</article>






  
  
</div>
      <footer id="footer">
  <div class="outer">
    <div id="footer-info">
    	<div class="footer-left">
    		&copy; 2015 franket268
    	</div>
      	<div class="footer-right">
      		<a href="http://hexo.io/" target="_blank">Hexo</a>  Theme <a href="https://github.com/litten/hexo-theme-yilia" target="_blank">Yilia</a> by Litten
      	</div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css" type="text/css">
  <script src="/fancybox/jquery.fancybox.pack.js" type="text/javascript"></script>


<script src="/js/mobile.js" type="text/javascript"></script>
<script src="/js/main.js" type="text/javascript"></script>





<! -- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
        processEscapes: true,
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
    }
});

MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i=0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';                 
    }       
});
</script>

<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>



  </div>
</body>
</html>